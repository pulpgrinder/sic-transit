<!DOCTYPE html>
<html lang="en">
<!-- Sic Transit Demo. Copyright 2023 by Anthony W. Hursh. MIT license -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-store,must-revalidate,max-age=-1">
    <meta http-equiv="Pragma" content="no-store">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="sic-transit.css">
    <link rel="stylesheet" href="sic-demo.css">
    <title>Sic Transit</title>
  </head>
  <body>
    <div id="demo-container">
        <div id="slide1" class="demo-panel">
            Slide 1
            <img title = "John Locke" src="johnlocke.jpg" height="100%"/>
        </div>
        <div id="slide2" class="demo-panel">
            Slide 2
        </div>
        <div id="slide3" class="demo-panel">
            Slide 3
        </div>
        <div id="slide4" class="demo-panel">
            Slide 4
        </div>
        <div id="slide5" class="demo-panel">
            Slide 5
        </div>
        <div id="slide6" class="demo-panel">
            Slide 6
        </div>
    </div>
    <div>
    Panel: <select title="panelSelector" id="panelSelector"></select>
    Transition: <select id="transitionSelector" title="transitionSelector"></select>
    <button title="performTransition" id="performTransition" onclick="runTransition()">Perform Transition</button>
    </div>
    <div>
        You can click any of the divs below to add it as a new panel.
    </div>
    <div id="testAdd1" onclick="addNewPanel(event)">
        Add Test #1
    </div>
    <div id = "testAdd2" onclick="addNewPanel(event)">
        Add Test #2
    </div>
    <div id="testAdd3" onclick="addNewPanel(event)">
        Add Test #3
    </div>
  </body>
  <script type="text/javascript" src="sic-transit.js"></script>
  <script type="text/javascript">

function addNewPanel(evt){
        let element = evt.target;
        transit.showPanel(element);
}
// Initialize a new instance of SicTransit.
 let transit = new SicTransit("#demo-container",".demo-panel");

function runTransition(){
    let panel = document.getElementById("panelSelector").value;
    let transition = document.getElementById("transitionSelector").value;
    transit.performTransition({panelSelector:panel,transitionName:transition});
}

// Set up a callback to be called after every transition completes. In this case, it just prints some info.
transit.setCallback(callbackDemo);

// This is our callback function.
    function callbackDemo(args){
        console.log("elementSelector: " + args.elementSelector);
        console.log("transitionName: " + args.transitionName);
        console.log("elapsed time: " + (args.endTime - args.startTime));
        transit.stackDump(args);
    }

// Load the UI.
function loadUI(){
    let transitions = Object.keys(transit.dispatchTable);
    let panels = transit.getPanelList();
    let transitionSelector = document.getElementById("transitionSelector");
    let panelSelector = document.getElementById("panelSelector");
    let transition;
    let element;
    for(let i = 0; i < panels.length; i++){
        element = document.createElement('option');
        element.value = "#" + panels[i];
        element.text = "#" + panels[i];
        panelSelector.appendChild(element);
    }
    for(let i = 0; i < transitions.length; i++){
        transition = document.createElement('option');
        transition.value = transitions[i];
        transition.text = transitions[i];
        transitionSelector.appendChild(transition);
    }
}

loadUI();

  </script>
 </html>